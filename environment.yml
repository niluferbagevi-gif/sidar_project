name: sidar-ai
channels:
  - conda-forge
  - defaults
dependencies:
  - python=3.11
  - pip
  - git
  - setuptools
  - wheel
  - packaging
  # ─── PyTorch ───────────────────────────────────────────────────────────────
  # WSL2 / Ubuntu / Conda ortamı için NOT:
  #   Conda'nın pytorch-cuda paketi, WSL2'nin Windows sürücüsünden gelen
  #   libcuda.so.1 stub'ı ile ÇAKIŞIR → GPU görünmez hale gelir.
  #   Bu yüzden PyTorch'u CONDA yerine PIP (CUDA wheel) üzerinden kuruyoruz.
  #
  #   RTX 3070 Ti Laptop (Compute 8.6 / Ampere) — CUDA 12.1 tam desteklidir.
  #   Pip bölümünde torch wheel ile kurulumu yapılmaktadır (aşağıya bakın).
  #
  #   GPU YOK ise pip bölümündeki extra-index-url satırını silin;
  #   torch ve torchvision standart PyPI CPU build'ı ile kurulur.
  - pip:
      # ── PyTorch CUDA 12.4 wheel index'i EK kaynak olarak ekle ────────────────
      # --extra-index-url: PyPI korunur, PyTorch CUDA wheel'ları ek kaynak olur.
      # (--index-url kullanmayın: PyPI'ı devre dışı bırakır, diğer paketler bulunamaz)
      # docker-compose.yml ile tutarlı: cu124 (CUDA 12.4)
      - --extra-index-url https://download.pytorch.org/whl/cu124

      # ── Temel ─────────────────────────────────────────────────────────────
      - python-dotenv>=1.0.0
      - pyyaml>=6.0.1
      # requests kaldırıldı — tüm HTTP istekleri httpx ile yapılmaktadır

      # ── Asenkron HTTP & Veri Doğrulama ────────────────────────────────────
      - httpx>=0.25.0
      - pydantic>=2.4.0

      # ── PyTorch — CUDA 12.4 (cu124 wheel) ────────────────────────────────────
      # cu124 index'ten CUDA 12.4 build seçilir (docker-compose.yml ile uyumlu)
      - torch>=2.4.0
      - torchvision>=0.19.0

      # ── Sistem İzleme ─────────────────────────────────────────────────────
      - psutil>=5.9.5
      # GPU sıcaklık, kullanım yüzdesi ve sürücü sürümü için (opsiyonel).
      # WSL2'de NVML erişimi kısıtlı olabilir (Windows sürücüsü bağımlı);
      # kod gracefully devre dışı kalır (hata vermez).
      - nvidia-ml-py>=12.535.77

      # ── Docker (Güvenli Kod Çalıştırma / REPL Sandbox) ────────────────────
      - docker>=6.0.0

      # ── AI Sağlayıcıları ──────────────────────────────────────────────────
      - google-generativeai>=0.7.0

      # ── GitHub Entegrasyonu ───────────────────────────────────────────────
      - PyGithub>=2.1.0

      # ── Web Arama ─────────────────────────────────────────────────────────
      - duckduckgo-search>=6.1.0

      # ── RAG (Vektör & BM25) ───────────────────────────────────────────────
      - rank-bm25>=0.2.2
      - chromadb>=0.4.0
      # sentence-transformers: USE_GPU=true ise CUDA üzerinde embedding yapar
      - sentence-transformers>=2.2.0

      # ── Web Arayüzü ───────────────────────────────────────────────────────
      - fastapi>=0.104.0
      - uvicorn[standard]>=0.24.0

      # ── Geliştirme & Test ─────────────────────────────────────────────────
      - pytest>=7.4.0
      - pytest-asyncio>=0.21.0
      - pytest-cov>=4.1.0
      - black>=23.0.0
      - flake8>=6.0.0
      - mypy>=1.5.0